<div class="flex flex-col relative gap-4 w-150 h-[100%]">
  <div class="flex justify-between">
    <div class="flex gap-8 w-[30%] mt-4">
      <button
        (click)="selectControle()"
        class="cursor-pointer text-lg text-center  rounded-lg p-2 font-bold border-2 "
        [ngClass]="{ one: control }"
      >
        Controles
      </button>
      <button
        (click)="selectArchive()"
        class=" cursor-pointer text-lg text-center  rounded-lg p-2  border-2 font-bold "
        [ngClass]="{ one: archive }"
      >
        Archives
    </button>
    </div>

    @if (control) {
    <div class="flex w-[30%] gap-4 mt-4 justify-end mr-3">
      <button
      (click)="exportExcel()"
        class="bg-[#1FA055] cursor-pointer text-lg text-center  text-white rounded-lg p-2 font-bold"
      >
        Exporter vers excel
      </button>

      <!-- import.component.html -->

      <button
        type="submit"
        (click)="fileInput.click()"
        class="bg-[#1FA055] cursor-pointer text-lg text-center  text-white rounded-lg p-2 font-bold "
      >
        Import
      </button>
      <input
        #fileInput
        type="file"
        style="display: none"
        (change)="onFileChange($event)"
        accept=".xlsx"
        required
      />

      <button
        (click)="openModal()"
        class="bg-[#1FA055] cursor-pointer text-lg text-center  text-white rounded-lg p-2 font-bold"
      >
        + Controle
      </button>
    </div>
    }
  </div>

  <div class="flex flex-col  shadow-sm  gap-2 overflow-x-auto h-[91%] p-1">
    <div
      [formGroup]="select"
      class="w-full shadow-md overflow-x-auto rounded gap-5 items-center h-16 flex justify-between p-1"
    >
      @if (display2) {
      <div class="flex gap-4">
        <!-- <label class="text-xl">Pays</label> -->
        <select
          formControlName="pays_id"
          class="bg-gray-50 border border-gray-400 w-60 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
        >
          <option value="0" disabled selected>filtrer par pays</option>
          @for (pays of contries(); track pays.id) {
          <option [value]="pays.id">{{ pays.libelle }}</option>
          }
        </select>
      </div>
      }
       <div class="flex gap-4">
        <!-- <label class="text-xl">Couverture</label> -->
        <select
          formControlName="couverture"
          class="bg-gray-50 border border-gray-400 w-44 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
        >
          <option value="0" disabled selected>filtrer par couverture</option>
          <option value="Exhaustivité">Exhaustivité</option>
          <option value="Non exhaustivité">Non exhaustivité</option>
        </select>
      </div>
      
      <div class="flex gap-4">
        <!-- <label class="text-xl">Statut</label> -->
        <select
          formControlName="statut"
          class="bg-gray-50 border border-gray-400 w-64 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
        >
          <option value="0" selected disabled>filtrer par statut</option>
          <option value="Fait">Fait</option>
          <option value="Non fait">Non fait</option>
          <option value="Applicable">Applicable</option>
          <option value="Non Applicable">Non applicable</option>
        
        </select>
      </div>
        <div class="flex gap-4">
        <!-- <label class="text-xl">Etat</label> -->
        <select
          formControlName="validate"
          class="bg-gray-50 border border-gray-400 w-32 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
        >
          <option value="0" selected disabled>filtrer par etat</option>
          <option value="Validé">Validé</option>
          <option value="Non validé">Non validé</option>
        </select>
      </div>
       <div class="flex gap-4">
       
        <select
          (click)="filtrerPar($event)"
          class="bg-gray-50 border border-gray-400 w-64 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
        >
          <option value="0" disabled selected>filtrer par</option>
          <option value="periodicite">Periodicité</option>
          <option value="typePar">Type</option>
          <option value="direction">Direction</option>
          <option value="pole">Pole</option>
          <option value="departement">Département</option>
          <option value="service">Service</option>
          <option value="risque">Risque</option>
          <option value="anne">Année</option>
        </select>
      </div>
      @if(options['periodicite']){
        <div class="flex gap-4">
         <select
           formControlName="periodicite"
           class="bg-gray-50 border border-gray-400 w-64 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
         >
           <option value="0" disabled selected>filtrer par periodicite</option>
           <option value="journalière">journalière</option>
           <option value="mensuelle">mensuelle</option>
           <option value="annuelle">annuelle</option>
         </select>
       </div>
      }
      @if(options['typePar']){
        <div class="flex gap-4">
          <!-- <label class="text-xl">Type</label> -->
          <select
            formControlName="type"
            class="bg-gray-50 border border-gray-400 w-64 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
          >
            <option value="">filtrer par type</option>
            @for (type of types(); track type.id) {
            <option [value]="type.id">{{ type.libelle }}</option>
            }
          </select>
        </div>
      }

      @if (display2) {
        @if(options['direction']){
        <div class="flex gap-4">
          <!-- <label class="text-xl">Direction</label> -->
          <select
            formControlName="direction_id"
            class="bg-gray-50 border border-gray-400 w-64 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
          >
            <option value="0">filtrer par direction</option>
            @for (direction of directions(); track direction.id) {
            <option [value]="direction.id">{{ direction.libelle }}</option>
            }
          </select>
        </div>
        }
        @if(options['departement']){
          <div class="flex gap-4">
            <!-- <label class="text-xl">Département</label> -->
            <select
              formControlName="departement_id"
              class="bg-gray-50 border border-gray-400 w-64 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
            >
              <option value="0">filtrer par département</option>
              @for (departement of departements(); track departement.id) {
              <option [value]="departement.id">{{ departement.libelle }}</option>
              }
            </select>
          </div>
        }
        @if(options['pole']){

          <div class="flex gap-4">
            <!-- <label class="text-xl">Pole</label> -->
            <select
              formControlName="pole_id"
              class="bg-gray-50 border border-gray-400 w-64 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
            >
              <option value="">filtrer par pole</option>
              @for (pole of poles(); track pole.id) {
              <option [value]="pole.id">{{ pole?.libelle }}</option>
              }
            </select>
          </div>
        }
        @if(options['service']){
          <div class="flex gap-4">
            <!-- <label class="text-xl">Service</label> -->
            <select
              formControlName="service_id"
              class="bg-gray-50 border border-gray-400 w-64 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
            >
              <option value="0">filtrer par service</option>
              @for (service of services(); track service.id) {
              <option [value]="service.id">{{ service.libelle }}</option>
              }
            </select>
          </div>
        }
        @if(options['activite']){
          <div class="flex gap-4">
            <!-- <label class="text-xl">Activite</label> -->
            <select
              formControlName="activite_id"
              class="bg-gray-50 border border-gray-400 w-64 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
            >
              <option value="0">filtrer par activité</option>
              @for (activite of activites(); track activite.id) {
              <option [value]="activite.id">{{ activite.libelle }}</option>
              }
            </select>
          </div>
        }
      }
      @if(options['risque']){
        <div class="flex gap-4">
          <!-- <label class="text-xl">Risque</label> -->
          <select
            formControlName="risque_id"
            class="bg-gray-50 border border-gray-400 w-64 h-12  form-control border-2  text-gray-900 text-lg rounded-lg focus:ring-primary-500 focus:border-primary-500 block dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
          >
            <option value="0">filtrer par risque</option>
            @for (risque of risques(); track risque.id) {
            <option [value]="risque.id">{{ risque.libelle }}</option>
            }
          </select>
        </div>
      }
      <!-- <div class="flex gap-4">
        <label class="text-xl">Controle</label>
        <select
          formControlName="controle_id"
          class="bg-white outline-none p-1 h-7 ring-1 ring-[#FF7900] rounded-xl shadow-md shadow-[#242a30] w-44 flex text-center"
        >
          <option value="0">filtrer par controle</option>
          @for (controle of controles(); track controle.id) {
          <option [value]="controle.id">{{ controle.nom_controle }}</option>
          }
        </select>
      </div> -->

     

     

      <!-- @if (display2) {
      <div class="flex gap-4">
        <label class="text-xl">Porteur</label>
        <select
          formControlName="user_id"
          class="bg-white outline-none p-1 h-7 ring-1 ring-[#FF7900] rounded-xl shadow-md shadow-[#242a30] w-44 flex text-center"
        >
          <option value="0">filtrer par porteur</option>
          @for (user of users(); track user.id) {
          <option [value]="user.id">{{ user.nom_complet }}</option>
          }
        </select>
      </div>
      } -->

     

    

    
<!-- 
      <div class="flex gap-4">
        <label class="text-xl">Année</label>
        <select
          formControlName="annee"
          class="bg-white outline-none p-1 h-7 ring-1 ring-[#FF7900] rounded-xl shadow-md shadow-[#242a30] w-44 flex text-center"
        >
          <option value="0">filtrer par année</option>
          <option value="2023">2023</option>
          <option value="2024">2024</option>
          <option value="2025">2025</option>
        </select>
      </div> -->
    </div>

    <div class="container   w-[100%] h-[100%] p-1 mt-2">
      <div class=" w-[106%]  overflow-y-auto" >
        <table class=" w-[100%]">
          <thead class="text-white bg-[#FF7900]  sticky left-0 z-20">
            <tr class="text-lg font-semibold ">
              <th>
                <div class="">Type controle</div>
              </th>
              <th>
                <div>Direction</div>
              </th>
              <th>
                <div>Pole</div>
              </th>
              <th>
                <div>Département</div>
              </th>
              <th>
                <div>Service concerné</div>
              </th>
              <th>
                <div>Activité/Domaine</div>
              </th>
              <th>
                <div>Nom du contrôle</div>
              </th>
              <th>
                <div>Code</div>
              </th>
              <th>
                <div>Descriptif</div>
              </th>
              <th>
                <div>Objectif</div>
              </th>
              <th>
                <div>Risque couvert</div>
              </th>
              <th>
                <div>Porteur</div>
              </th>
              <th>
                <div>Périodicité</div>
              </th>
              <th>
                <div>Couverture</div>
              </th>
              <th>
                <div>Preuve demandée</div>
              </th>
              <th>
                <div>Commentaire</div>
              </th>
              <th>
                <div>Statut</div>
              </th>
              <th>
                <div>Etat</div>
              </th>
              <th>
                @if (control) {
                <div>Date d'ajout</div>
                } @if (archive) {
                <div>Date d'archive</div>
                }
              </th>
              <th>
                <div>Actions</div>
              </th>
            </tr>
          </thead>
          <tbody>
            <!-- <div>dcvkzdnnnnnnvvnvkv,ed</div> -->
            @if (control) {
               @for (data of datas()  |
               direction2:selectedDir |periodicite:selectedPrd |statut:selectedStat 
               |validate:selectedVal |risque:selectedRisk 
               |activite:selectedAct |departement2:selectedDept
               |couverture:selectedCouv |porteur:selectedUser |service2:selectedServ
               |polectrl:selectedPole |annee:selectedYear
               
            ; track data.id;) {
             <!-- < <pre>{{data|json}}</pre>  -->
             <!-- sticky left-0 z-20 -->
            <tr class="bg-white">
              <td class="">
               @if(data?.type_controle_id && isObject(data.type_controle_id)){
                <div class="" >{{ data?.type_controle_id?.libelle }}</div>
               }@else{
                <div class="" >N/A</div>
               }
              </td>
              <td>
                <div>{{ data?.direction_id?.libelle }}</div>
              </td>
              <td>
               @if(data?.pole_id && isObject(data?.pole_id)){
                <div>{{ data?.pole_id?.libelle }}</div>
               }@else{
                <div>N/A</div>
               }
              </td>
              <td>
                <div>{{ data?.departement_id?.libelle }}</div>
              </td>
              <td>
                <div>{{ data?.service_id?.libelle }}</div>
              </td>
              <td>
                <div>{{ data?.activite_id?.libelle }}</div>
              </td>
              <td>
                <div>{{ data?.controle }}</div>
              </td>
              <td>
                <div>{{ data?.code }}</div>
              </td>
              <td>
                <div>{{ data?.descriptif }}</div>
              </td>
              <td>
                <div style="max-height: 80px; overflow: auto; word-wrap: break-word;">
                  {{ data?.objectif }}
                </div>
              </td>
              
              
              <td>
                <div *ngIf="data?.risque_id && isObject(data.risque_id); else noRisque">
                  <div>{{ data.risque_id.libelle }}</div>
              </div>
              <ng-template #noRisque>
                  <div>N/A</div>
              </ng-template>
              
              </td>
              <td>
                <div>{{ data?.user_id?.nom_complet }}</div>
              </td>
              <td>
                <div>{{ data?.periodicite }}</div>
              </td>
              <td>
                <div>{{ data?.exhaustivite }}</div>
              </td>
              <td>
                <div>
                  <textarea readonly>{{ data?.preuve }}</textarea>
                </div>
              </td>
              <!-- <td>
                    <div><a target="_blank" [href]="'http://localhost:8000/storage/'+data.fichier"><i class="material-icons">attach_file</i>Fichier Preuve</a></div>
                  </td> -->
              <td>
                <div>
                  <textarea readonly>{{ data?.commentaire }}</textarea>
                </div>
              </td>
              <td>
                
                <div>{{data?.etat}}</div>
              </td>
              <td>
                <div>
                  {{ data.validate }}
                </div>
              </td>
              <td>
                
                <div>{{data?.date_ajout}}</div>
              </td>
              <td>
                <div class="flex gap-2">
                  <div
                    class="icon-wrapper"
                    (mouseenter)="setHoveredIcon(data.id, 'visibility')"
                    (mouseleave)="clearHoveredIcon(data.id)"
                  >
                    <i
                      (click)="info(data)"
                      class="material-icons cursor-pointer text-gray-600"
                      >visibility</i
                    >
                    <div
                      class="tooltip"
                     *ngIf="hoveredIcon[data.id]==='invisibility'"
                    >
                      voir fiche control
                    </div>
                  </div>
                  <div
                    class="icon-wrapper"
                    (mouseenter)="setHoveredIcon(data.id, 'edit')"
                    (mouseleave)="clearHoveredIcon(data.id)"
                  >
                    <i
                      (click)="editModal(data)"
                      class="material-icons cursor-pointer text-yellow-400"
                      >edit</i
                    >
                    <div
                      class="tooltip"
                      *ngIf="hoveredIcon[data.id]==='edit'"
                    >
                      editer le control
                    </div>
                  </div>
                  @if (display2 && pays_id== data?.user_id?.pays_id?.id ) {
                  <div
                    class="icon-wrapper"
                    (mouseenter)="setHoveredIcon(data.id, 'archive')"
                    (mouseleave)="clearHoveredIcon(data.id)"
                  >
                    <i
                      (click)="deleteD(data.id)"
                      class="material-icons cursor-pointer text-orange-600"
                      >archive</i
                    >
                    <div
                      class="tooltip"
                      *ngIf="hoveredIcon[data.id]==='archive'"
                    >
                      Archiver le control
                    </div>
                  </div>
               
                  @if(pays_id== data?.user_id?.pays_id?.id){

                    <div
                      class="icon-wrapper"
                      *ngIf="data.validate === 'Non validé'"
                      (mouseenter)="setHoveredIcon(data.id, 'check_circle')"
                      (mouseleave)="clearHoveredIcon(data.id)"
                    >
                      <i
                        (click)="validate(data.id)"
                        class="material-icons cursor-pointer text-green-600"
                        >check_circle</i
                      >
                      <div
                        class="tooltip"
                        *ngIf="hoveredIcon[data.id]==='check_circle'"
                      >
                        valider le control
                      </div>
                    </div>
                  }

                  <div
                    class="icon-wrapper"
                    *ngIf="data.validate === 'Validé'"
                    (mouseenter)="setHoveredIcon(data.id, 'cancel')"
                    (mouseleave)="clearHoveredIcon(data.id)"
                  >
                    <i
                      (click)="invalidate(data.id)"
                      class="material-icons cursor-pointer text-red-600"
                      >cancel</i
                    >
                    <div
                      class="tooltip"
                      *ngIf="hoveredIcon[data.id]==='cancel'"
                    >
                      dévalider le control
                    </div>
                  </div>
                  }
                </div>
              </td>
            </tr>

            } 
          } @if (archive) { @for (data of archives() |
            direction2:selectedDir |periodicite:selectedPrd |statut:selectedStat
            |validate:selectedVal |risque:selectedRisk |controle:selectedCtrl
            |activite:selectedAct |departement2:selectedDept
            |couverture:selectedCouv |porteur:selectedUser
            |polectrl:selectedPole |service2:selectedServ ; track data.id) {
            <tr class="bg-white">
              <td>
                <div>{{ data.type_controle_id?.libelle }}</div>
              </td>
              <td>
                <div>{{ data.direction_id.libelle }}</div>
              </td>
              <td>
                <div>{{ data.pole_id?.libelle }}</div>
              </td>
              <td>
                <div>{{ data.departement_id.libelle }}</div>
              </td>
              <td>
                <div>{{ data.service_id.libelle }}</div>
              </td>
              <td>
                <div>{{ data.activite_id.libelle }}</div>
              </td>
              <td>
                <div>{{ data.controle }}</div>
              </td>
              <td>
                <div>{{ data.code }}</div>
              </td>
              <td>
                <div>{{ data.descriptif }}</div>
              </td>
              <td>
                <div>{{ data.objectif }}</div>
              </td>
              <td>
                <div>{{ data.risque_id.libelle }}</div>
              </td>
              <td>
                <div>{{ data.user_id.nom_complet }}</div>
              </td>
              <td>
                <div>{{ data.periodicite }}</div>
              </td>
              <td>
                <div>{{ data.exhaustivite }}</div>
              </td>
              <td>
                <div>
                  <textarea readonly>{{ data.preuve }}</textarea>
                </div>
              </td>
              <!-- <td>
                                  <div><a target="_blank" [href]="'http://localhost:8000/storage/'+data.fichier"><i class="material-icons">attach_file</i>Fichier Preuve</a></div>
                                </td> -->
              <td>
                <div>
                  <textarea readonly>{{ data.commentaire }}</textarea>
                </div>
              </td>
               <!-- <td>
                <div>
                  <textarea readonly>{{ data.etat }}</textarea>
                </div>
              </td> -->
              <td>

                <div>{{data.etat}}</div>
                
  
              </td>
              <td>
                <div>
                  {{ data.validate }}
                </div>
              </td>
              <td>
                <div>{{ data.date_ajout }}</div>
              </td>
              <td>
                <div class="flex gap-2">
                  <div
                    class="icon-wrapper"
                    (mouseenter)="setHoveredIcon(data.id, 'visibility')"
                    (mouseleave)="clearHoveredIcon(data.id)"
                  >
                    <i
                      (click)="info(data)"
                      class="material-icons cursor-pointer text-gray-600"
                      >visibility</i
                    >
                    <div
                      class="tooltip"
                      *ngIf="hoveredIcon[data.id] === 'visibility'"
                    >
                      voir fiche control
                    </div>
                  </div>
                  <div
                    class="icon-wrapper"
                    (mouseenter)="setHoveredIcon(data.id, 'archive')"
                    (mouseleave)="clearHoveredIcon(data.id)"
                  >
                    <i
                      (click)="desarchiver(data.id)"
                      class="material-icons cursor-pointer text-orange-600"
                      >unarchive</i
                    >
                    <div
                      class="tooltip"
                      *ngIf="hoveredIcon[data.id] === 'archive'"
                    >
                      Désarchiver le control
                    </div>
                  </div>
                  <!-- <i (click)="desarchiver(data.id)" class="material-icons cursor-pointer text-red-600">archive</i> -->
                </div>
              </td>
            </tr>
            } }
          </tbody>
        </table>
      </div>
    </div>


  </div>
  

  <div
    class="z-50 fixed inset-0 bg-gray-900 bg-opacity-75 flex justify-center items-center"
    style="display: none"
    id="modal"
  >
    <div
      class="mt-20 ml-[24rem] w-[70%] h-[100%] flex flex-col gap-4 rounded-[6px] ring-2 ring-[#242a30]"
    >
      <div class="relative bg-white h-[88%] rounded-lg shadow dark:bg-gray-700">
        <div
          class="flex items-center justify-between p-4 md:p-5 border-b rounded-t bg-[#FF7900]"
        >
          <h3 class="text-2xl font-semibold text-white">
            {{ title }}
          </h3>
          <button
            (click)="closeModal()"
            class="text-white rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center"
            data-modal-toggle="crud-modal"
          >
            <svg
              class="w-3 h-3"
              aria-hidden="true"
              fill="none"
              viewBox="0 0 14 14"
            >
              <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
              />
            </svg>
            <span class="sr-only">Close modal</span>
          </button>
        </div>

        <form
          [formGroup]="Data"
          class="flex flex-col gap-16 p-4 md:p-5 overflow-y-auto h-[87%]"
        >
          <div class="grid gap-4 mb-4 grid-cols-2">
            <div class="col-span-2 sm:col-span-1">
              <label for="nom_controle"
                class="block mb-2 form-label required text-sm font-medium text-gray-900 dark:text-white"
                >Nom controle</label
              >
              <input
                type="text"
                id="nom_controle"
                formControlName="controle"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                placeholder="entrer le nom du controle"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('controle')?.invalid &&(Data.get('controle')?.touched || Data.get('controle')?.dirty),
                           'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('controle')?.valid &&(Data.get('controle')?.touched || Data.get('controle')?.dirty)}"
              />
              @if(Data.get('controle')?.invalid && Data.get('controle')?.touched){
                @if(Data.get('controle')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
              <!-- <select formControlName="controle_id"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                <option value=0>choisir une controle</option>
                @for (ctrl of controles(); track ctrl.id) {
                  <option [value]="ctrl.id">{{ctrl.nom_controle}}</option>
                }
              </select> -->
            </div>
            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Code</label
              >
              <input
                type="text"
                formControlName="code"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                placeholder="entrer le code du controle"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('code')?.invalid &&(Data.get('code')?.touched || Data.get('code')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('code')?.valid &&(Data.get('code')?.touched || Data.get('code')?.dirty)}"
              />
              @if(Data.get('code')?.invalid && Data.get('code')?.touched){
                @if(Data.get('code')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            </div>
            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Objectif</label
              >
              <textarea
                formControlName="objectif"
                placeholder="entrer l'objectif du controle"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
              
              [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('objectif')?.invalid &&(Data.get('objectif')?.touched || Data.get('objectif')?.dirty),
                           'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('objectif')?.valid &&(Data.get('objectif')?.touched || Data.get('objectif')?.dirty)}"
              ></textarea>
              @if(Data.get('objectif')?.invalid && Data.get('objectif')?.touched){
                @if(Data.get('objectif')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            </div>
            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Descriptif</label
              >
              <textarea
                formControlName="descriptif"
                placeholder="entrer le descriptif du controle"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('descriptif')?.invalid &&(Data.get('descriptif')?.touched || Data.get('descriptif')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('descriptif')?.valid &&(Data.get('descriptif')?.touched || Data.get('descriptif')?.dirty)}"
              ></textarea>
              @if(Data.get('descriptif')?.invalid && Data.get('descriptif')?.touched){
                @if(Data.get('descriptif')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            
            </div>
            <div class="col-span-2 mt-8 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Type Controle</label
              >
              @if(!autreType){
                <select
                  formControlName="type" (click)="selectType($event)"
                  class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" 
                >
                  <option value="" selected disabled>choisir un type de controle</option>
                  @for (type of types(); track type.id) {
                  <option [value]="type.id">{{ type.libelle }}</option>
                  }
                  <option  value="autre">Autre</option>
                </select>
              }@else{
                <input
                type="text"
                id="nom_controle"
                formControlName="type"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                placeholder="entrer le type de controle"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('type')?.invalid &&(Data.get('type')?.touched || Data.get('type')?.dirty),
                           'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('type')?.valid &&(Data.get('type')?.touched || Data.get('type')?.dirty)}"
              />
              @if(Data.get('type')?.invalid && Data.get('type')?.touched){
                @if(Data.get('type')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
              }
              <!-- @if(Data.get('type')?.invalid && Data.get('type')?.touched){
                @if(Data.get('type')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              } -->
            </div>
            <div class="col-span-2 mt-8  sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Risque</label
              >
              @if(!autreRisque){
              <select
                formControlName="risque_id"
                (click)="selectedRisque($event)"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('risque_id')?.invalid &&(Data.get('risque_id')?.touched || Data.get('risque_id')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('risque_id')?.valid &&(Data.get('risque_id')?.touched || Data.get('risque_id')?.dirty)}"
                >
                <option value="" disabled selected>choisir un risque</option>
                @for (risque of risques(); track risque.id) {
                <option [value]="risque.id">{{ risque.libelle }}</option>
                }
                <option value="autre">Autre</option>
              </select>
            }@else{
              <input
              type="text"
              
              formControlName="risque_id"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
              placeholder="entrez le libelle"
              [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('risque_id')?.invalid &&(Data.get('risque_id')?.touched || Data.get('risque_id')?.dirty),
                         'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('risque_id')?.valid &&(Data.get('risque_id')?.touched || Data.get('risque_id')?.dirty)}"
            />
            }
              @if(Data.get('risque_id')?.invalid && Data.get('risque_id')?.touched){
                @if(Data.get('risque_id')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            </div>
            <div class="col-span-2 mt-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Porteur</label
              >
              <input
              type="text"
              formControlName="user_id" readonly
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
              placeholder="entrer le code du controle"
            />
              <!-- <select [disabled]="true"
                formControlName="user_id"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
              >
                <option value="" disabled selected>choisir un porteur</option>
                @for (user of users(); track user.id) {
                <option [value]="user.id">{{ user.nom_complet }}</option>
                }
              </select> -->
            </div>
            <div class="col-span-2 mt-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Direction</label
              >
              <select
                formControlName="direction_id"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('direction_id')?.invalid &&(Data.get('direction_id')?.touched || Data.get('direction_id')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('direction_id')?.valid &&(Data.get('direction_id')?.touched || Data.get('direction_id')?.dirty)}"
                >
                <option value="" selected disabled>choisir une direction</option>
                @for (direction of directions(); track direction.id) {
                <option [value]="direction.id">{{ direction.libelle }}</option>
                }
              </select>
              @if(Data.get('direction_id')?.invalid && Data.get('direction_id')?.touched){
                @if(Data.get('direction_id')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            </div>
            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Pole</label
              >
              <select
                formControlName="pole_id"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('pole_id')?.invalid &&(Data.get('pole_id')?.touched || Data.get('pole_id')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('pole_id')?.valid &&(Data.get('pole_id')?.touched || Data.get('pole_id')?.dirty)}"
                >
                <option value="" selected disabled>choisir une pole</option>
                @for (pole of poles(); track pole.id) {
                <option [value]="pole.id">{{ pole.libelle }}</option>
                }
              </select>
              @if(Data.get('pole_id')?.invalid && Data.get('pole_id')?.touched){
                @if(Data.get('pole_id')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            </div>
            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Département</label
              >
              <select
                formControlName="departement_id"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('departement_id')?.invalid &&(Data.get('departement_id')?.touched || Data.get('departement_id')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('departement_id')?.valid &&(Data.get('departement_id')?.touched || Data.get('departement_id')?.dirty)}"
                >
                <option value="" selected disabled>choisir un département</option>
                @for (departement of departements(); track departement.id) {
                <option [value]="departement.id">
                  {{ departement.libelle }}
                </option>
                }
              </select>
              @if(Data.get('departement_id')?.invalid && Data.get('departement_id')?.touched){
                @if(Data.get('departement_id')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            </div>
            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Service</label
              >
              <select
                formControlName="service_id"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('service_id')?.invalid &&(Data.get('service_id')?.touched || Data.get('service_id')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('service_id')?.valid &&(Data.get('service_id')?.touched || Data.get('service_id')?.dirty)}"
              >
                <option value="" selected disabled>choisir une service</option>
                @for (service of services(); track service.id) {
                <option [value]="service.id">{{ service.libelle }}</option>
                }
              </select>
              @if(Data.get('service_id')?.invalid && Data.get('service_id')?.touched){
                @if(Data.get('service_id')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            </div>
            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Activité</label
              >
              <select
                formControlName="activite_id"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('activite_id')?.invalid &&(Data.get('activite_id')?.touched || Data.get('activite_id')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('activite_id')?.valid &&(Data.get('activite_id')?.touched || Data.get('activite_id')?.dirty)}"
                >
                <option value="" selected disabled>choisir une activité</option>
                @for (activite of activites(); track activite.id) {
                <option [value]="activite.id">{{ activite.libelle }}</option>
                }
              </select>
              @if(Data.get('activite_id')?.invalid && Data.get('activite_id')?.touched){
                @if(Data.get('activite_id')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            </div>
            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Périodicité</label
              >
              @if(!autrePeriodicite){
              <select
                    formControlName="periodicite"
                    (click)="selectedPeriodicite($event)"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                    [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('periodicite')?.invalid &&(Data.get('periodicite')?.touched || Data.get('periodicite')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('periodicite')?.valid &&(Data.get('periodicite')?.touched || Data.get('periodicite')?.dirty)}"
                    >
                    <option value="" selected disabled>filtrer par periodicite</option>
                    <option value="journalière">journalière</option>
                    <option value="mensuelle">mensuelle</option>
                    <option value="annuelle">annuelle</option>
                    <option value="autre">Autre</option>
              </select>
            }@else{
              <input
              type="text"
              id=""
              formControlName="periodicite"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
              placeholder="entrez le libelle"
              [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('periodicite')?.invalid &&(Data.get('periodicite')?.touched || Data.get('periodicite')?.dirty),
                         'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('periodicite')?.valid &&(Data.get('periodicite')?.touched || Data.get('periodicite')?.dirty)}"
            />
            }
              @if(Data.get('periodicite')?.invalid && Data.get('periodicite')?.touched){
                @if(Data.get('periodicite')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
              <!-- <input
                type="text"
                formControlName="periodicite"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                placeholder="entrer la periodicité"
              /> -->
            </div>
            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Couverture</label
              >
              @if(!autreExhaustivite){
              <select
                formControlName="exhaustivite"
                (click)="selectedExhaustivite($event)"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('exhaustivite')?.invalid &&(Data.get('exhaustivite')?.touched || Data.get('exhaustivite')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('exhaustivite')?.valid &&(Data.get('exhaustivite')?.touched || Data.get('exhaustivite')?.dirty)}"
                >
                <option value="" selected disabled>choisir une couverture</option>
                <option value="Exhaustivité">Exhaustivité</option>
                <option value="Non exhaustivité">Non exhaustivité</option>
                <option value="autre">Autre</option>
              </select>
            }@else{
              <input
              type="text"
              
              formControlName="exhaustivite"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
              placeholder="entrer le libelle "
              [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('exhaustivite')?.invalid &&(Data.get('exhaustivite')?.touched || Data.get('exhaustivite')?.dirty),
                         'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('exhaustivite')?.valid &&(Data.get('exhaustivite')?.touched || Data.get('exhaustivite')?.dirty)}"
            />
            }
              @if(Data.get('exhaustivite')?.invalid && Data.get('exhaustivite')?.touched){
                @if(Data.get('exhaustivite')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            </div>
            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Preuves demandées</label
              >
              <input
                type="text"
                formControlName="preuve"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                placeholder="saisir la preuve demandée"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('preuve')?.invalid &&(Data.get('preuve')?.touched || Data.get('preuve')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('preuve')?.valid &&(Data.get('preuve')?.touched || Data.get('preuve')?.dirty)}"
              />
              @if(Data.get('preuve')?.invalid && Data.get('preuve')?.touched){
                @if(Data.get('preuve')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            </div>

            <div class="col-span-2 sm:col-span-1">
              <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                Fichiers preuves
              </label>
              <input
                type="file"
                (change)="onFileSelected($event)"
                multiple
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
              />
            
              <div *ngIf="fileCount > 0" class="file-container mt-2">
                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                  Fichiers sélectionnés ({{ fileCount }})
                </label>
                <ul class="file-list">
                  <li *ngFor="let file of files" class="file-item">
                    <a (click)="openFile(file)" class="file-link">
                      {{ file.name }}
                    </a>
                  </li>
                </ul>
              </div>
            </div>

            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Statut</label
              >
              @if(!autreEtat){
              <select
                formControlName="etat"
                (click)="selectedEtat($event)"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('etat')?.invalid &&(Data.get('etat')?.touched || Data.get('etat')?.dirty),
                'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('etat')?.valid &&(Data.get('etat')?.touched || Data.get('etat')?.dirty)}"
                >
                <option value="" selected disabled>choisir un statut</option>
                <option value="Applicable">Applicable</option>
                <option value="Non Applicable">Nom Applicable</option>
                <option value="Fait">Fait</option>
                <option value="Non fait">Non fait</option>
                <option value="autre">Autre</option>
              </select>
            }@else{
              <input
              type="text"
              formControlName="etat"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
              placeholder="entrer un statut"
              [ngClass]="{'floating_outlined_error  dark:border-red-500 border-red-600 dark:focus:border-red-500 focus:outline-none focus:ring-0 focus:border-red-600':Data.get('etat')?.invalid &&(Data.get('etat')?.touched || Data.get('etat')?.dirty),
                         'floating_outlined_success  dark:border-green-500 border-green-600 dark:focus:border-green-500 focus:outline-none focus:ring-0 focus:border-green-600':Data.get('etat')?.valid &&(Data.get('etat')?.touched || Data.get('etat')?.dirty)}"
            />
            }
              @if(Data.get('etat')?.invalid && Data.get('etat')?.touched){
                @if(Data.get('etat')?.hasError('required')){
                  <div class="text-red-600 text-ms">Ce champs est obligatoire</div>
                }
              }
            </div>
            <div class="col-span-2 sm:col-span-1">
              <label
                class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                >Commentaire</label
              >
              <textarea
                formControlName="commentaire"
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
              ></textarea>

            </div>
          </div>
          <div class="flex">
            <button
              (click)="addOrUp()"
              [disabled]="Data.invalid"
              class="text-white bg-[#FF7900] inline-flex items-center font-medium rounded-lg text-lg px-5 py-2.5 text-center dark:bg-orange-600"
            >
              {{ btn }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

</div>
